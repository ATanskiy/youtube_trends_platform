{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-12-20T23:45:27.967772Z", "invocation_id": "053d993e-b2d1-4e1f-ad17-462ebd19fdfb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.502446Z", "completed_at": "2025-12-20T23:45:06.528471Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.557283Z", "completed_at": "2025-12-20T23:45:14.062440Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 7.623018980026245, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.dim_languages", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT\n        id          AS language_id,\n        name        AS language_name,\n        CAST(created_at AS TIMESTAMP) AS created_at\n    FROM bronze.languages\n)\n\nSELECT *\nFROM src", "relation_name": "silver.dim_languages", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.491562Z", "completed_at": "2025-12-20T23:45:06.541138Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.589933Z", "completed_at": "2025-12-20T23:45:14.340374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.897244691848755, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.dim_categories", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT\n        id          AS category_id,\n        name        AS category_name,\n        CAST(created_at AS TIMESTAMP) AS   created_at\n    FROM bronze.categories\n)\n\nSELECT *\nFROM src", "relation_name": "silver.dim_categories", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.505980Z", "completed_at": "2025-12-20T23:45:06.535413Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.585312Z", "completed_at": "2025-12-20T23:45:14.396567Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 7.961567401885986, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.dim_regions", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT\n        id          AS region_id,\n        name        AS region_name,\n        CAST(created_at AS TIMESTAMP) AS created_at\n    FROM bronze.regions\n)\n\nSELECT *\nFROM src", "relation_name": "silver.dim_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.514830Z", "completed_at": "2025-12-20T23:45:06.541474Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.593844Z", "completed_at": "2025-12-20T23:45:15.811262Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 9.373083353042603, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.fct_videos", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT\n        id AS video_id,\n        region_id,\n        language_id,\n        language_id_src,\n        channel_id,\n        category_id,\n        CAST(view_count AS BIGINT)      AS view_count,\n        CAST(like_count AS BIGINT)      AS like_count,\n        CAST(favorite_count AS BIGINT)  AS favorite_count,\n        CAST(comment_count AS BIGINT)   AS comment_count,\n        CAST(published_at AS TIMESTAMP) AS published_at,\n        CAST(created_at AS TIMESTAMP)   AS snapshot_at\n    FROM bronze.videos\n\n    \n      WHERE created_at > (\n          SELECT COALESCE(MAX(snapshot_at), TIMESTAMP '1970-01-01')\n          FROM silver.fct_videos\n      )\n    \n),\n\ndeduped AS (\n    SELECT *\n    FROM (\n        SELECT\n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY video_id, region_id, snapshot_at\n                ORDER BY snapshot_at DESC\n            ) AS rn\n        FROM src\n    )\n    WHERE rn = 1\n)\n\nSELECT\n    video_id,\n    region_id,\n    language_id,\n    language_id_src,\n    channel_id,\n    category_id,\n    view_count,\n    like_count,\n    favorite_count,\n    comment_count,\n    published_at,\n    snapshot_at\nFROM deduped", "relation_name": "silver.fct_videos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.498741Z", "completed_at": "2025-12-20T23:45:06.526876Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.530092Z", "completed_at": "2025-12-20T23:45:16.641126Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 10.182932615280151, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.dim_channels", "compiled": true, "compiled_code": "\n\nWITH ranked AS (\n    SELECT\n        channel_id,\n        channel_title,\n        created_at AS updated_at,\n        ROW_NUMBER() OVER (\n            PARTITION BY channel_id\n            ORDER BY created_at DESC\n        ) AS rn\n    FROM bronze.videos\n)\n\nSELECT\n    channel_id,\n    channel_title,\n    updated_at\nFROM ranked\nWHERE rn = 1", "relation_name": "silver.dim_channels", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:15.869908Z", "completed_at": "2025-12-20T23:45:15.888090Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:15.889795Z", "completed_at": "2025-12-20T23:45:20.728441Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 4.9068732261657715, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.fct_videos_growth", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT\n        video_id,\n        region_id,\n        language_id,\n        language_id_src,\n        channel_id,\n        category_id,\n        published_at,\n        snapshot_at,\n        view_count,\n        like_count,\n        favorite_count,\n        comment_count\n    FROM silver.fct_videos\n\n),\n\n\n    history AS (\n    SELECT\n        video_id,\n        region_id,\n        language_id,\n        language_id_src,\n        channel_id,\n        category_id,\n        published_at,\n        snapshot_at,\n        view_count,\n        like_count,\n        favorite_count,\n        comment_count\n    FROM silver.fct_videos_growth\n    UNION ALL\n    SELECT\n        video_id,\n        region_id,\n        language_id,\n        language_id_src,\n        channel_id,\n        category_id,\n        published_at,\n        snapshot_at,\n        view_count,\n        like_count,\n        favorite_count,\n        comment_count\n    FROM base\n    WHERE snapshot_at > (SELECT MAX(snapshot_at) FROM silver.fct_videos_growth)\n\n),\n\n\ngrowth AS (\n    SELECT\n        *,\n        CAST(view_count - LAG(view_count) \n            OVER (PARTITION BY video_id, region_id ORDER BY snapshot_at)\n            AS BIGINT\n        ) AS view_growth,\n\n        CAST(like_count - LAG(like_count) \n            OVER ( PARTITION BY video_id, region_id ORDER BY snapshot_at) AS BIGINT) \n            AS like_growth,\n\n        CAST(favorite_count - LAG(favorite_count) \n            OVER (PARTITION BY video_id, region_id ORDER BY snapshot_at)AS BIGINT) \n            AS favorite_growth,\n\n        CAST(comment_count - LAG(comment_count) \n            OVER (PARTITION BY video_id, region_id ORDER BY snapshot_at)AS BIGINT) \n            AS comment_growth\n    FROM history\n)\n\nSELECT *\nFROM growth\n\n\n    WHERE snapshot_at > (SELECT MAX(snapshot_at) FROM silver.fct_videos_growth)\n", "relation_name": "silver.fct_videos_growth", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:06.509175Z", "completed_at": "2025-12-20T23:45:06.529029Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:06.581135Z", "completed_at": "2025-12-20T23:45:23.169488Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 16.71147632598877, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.dim_videos", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n\n    SELECT\n        id AS video_id,\n        title,\n        description,\n        duration,\n        CAST(published_at AS TIMESTAMP) AS published_at,\n        category_id,\n        channel_id,\n        CAST(created_at AS TIMESTAMP) AS created_at\n    FROM bronze.videos\n\n),\n\nmax_loaded AS (\n\n    \n        SELECT MAX(created_at) AS max_created_at\n        FROM silver.dim_videos\n    \n\n),\n\nfiltered AS (\n\n    SELECT s.*\n    FROM source_data s\n    CROSS JOIN max_loaded m\n    WHERE s.created_at > m.max_created_at\n\n),\n\nranked AS (\n\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY video_id\n            ORDER BY created_at DESC\n        ) AS rn\n    FROM filtered\n\n)\n\nSELECT\n    video_id,\n    title,\n    description,\n    duration,\n    published_at,\n    category_id,\n    channel_id,\n    created_at\nFROM ranked\nWHERE rn = 1", "relation_name": "silver.dim_videos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:23.203596Z", "completed_at": "2025-12-20T23:45:23.221320Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:23.222827Z", "completed_at": "2025-12-20T23:45:25.995353Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.8306522369384766, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.videos_enriched", "compiled": true, "compiled_code": "\n\nSELECT\n    g.video_id,\n    g.region_id,\n    g.language_id,\n    g.language_id_src,\n    g.channel_id,\n    g.category_id,\n    g.snapshot_at        AS video_snapshot_at,\n    g.published_at       AS video_published_at,\n    g.view_count,\n    g.like_count,\n    g.favorite_count,\n    g.comment_count,\n\n    COALESCE(g.view_growth, 0)     AS view_growth,\n    COALESCE(g.like_growth, 0)     AS like_growth,\n    COALESCE(g.favorite_growth, 0) AS favorite_growth,\n    COALESCE(g.comment_growth, 0)  AS comment_growth,\n\n    v.title,\n    v.duration,\n    ch.channel_title,\n    c.category_name,\n\n    COALESCE(\n        l.language_name,\n        CASE g.language_id_src\n            WHEN 'ab'  THEN 'Abkhazian'\n            WHEN 'aa'  THEN 'Afar'\n            WHEN 'ff'  THEN 'Fulah'\n            WHEN 'vro' THEN 'V\u00f5ro'\n            WHEN 'mo'  THEN 'Moldovan'\n            WHEN 'wo'  THEN 'Wolof'\n            WHEN 'ht'  THEN 'Haitian Creole'\n            WHEN 'sn'  THEN 'Shona'\n            WHEN 'fa'  THEN 'Persian'\n            WHEN 'yue' THEN 'Cantonese'\n            WHEN 'pt'  THEN 'Portuguese'\n            WHEN 'zh'  THEN 'Chinese'\n            WHEN 'bn'  THEN 'Bengali'\n            WHEN 'bh'  THEN 'Bihari'\n            WHEN 'ki'  THEN 'Kikuyu'\n            WHEN 'nl'  THEN 'Dutch'\n            WHEN 'de'  THEN 'German'\n            WHEN 'ig'  THEN 'Igbo'\n            WHEN 'yo'  THEN 'Yoruba'\n            WHEN 'ps'  THEN 'Pashto'\n            WHEN 'tg'  THEN 'Tajik'\n            WHEN 'sh'  THEN 'Serbo-Croatian'\n            WHEN 'jv'  THEN 'Javanese'\n            WHEN 'und' THEN 'Undetermined'\n            WHEN 'zxx' THEN 'No linguistic content'\n            WHEN 'en'  THEN 'English'\n            WHEN 'es'  THEN 'Spanish'\n            WHEN 'fr'  THEN 'French'\n            ELSE NULL\n        END\n    ) AS language_name,\n\n    r.region_name,\n    rg.latitude,\n    rg.longitude\n\nFROM silver.fct_videos_growth g\nLEFT JOIN silver.dim_videos v       ON g.video_id = v.video_id\nLEFT JOIN silver.dim_channels ch    ON g.channel_id = ch.channel_id\nLEFT JOIN silver.dim_categories c   ON g.category_id = c.category_id\nLEFT JOIN silver.dim_languages l    ON g.language_id = l.language_id\nLEFT JOIN silver.dim_regions r      ON g.region_id = r.region_id\nLEFT JOIN silver.dim_regions_geo rg ON g.region_id = rg.region_id\n\n\nWHERE g.snapshot_at >\n    (SELECT max(video_snapshot_at) FROM gold.videos_enriched)\n", "relation_name": "gold.videos_enriched", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-20T23:45:26.045728Z", "completed_at": "2025-12-20T23:45:26.063037Z"}, {"name": "execute", "started_at": "2025-12-20T23:45:26.064829Z", "completed_at": "2025-12-20T23:45:27.896211Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.873302936553955, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.youtube_trends_platform.videos_enriched_tableau", "compiled": true, "compiled_code": "\n\nSELECT\n    video_id,\n    region_id,\n    language_id,\n    language_id_src,\n    channel_id,\n    category_id,\n\n    video_snapshot_at,\n    video_published_at,\n\n    CAST(video_snapshot_at AS DATE)                  AS video_snapshot_at_d,\n    date_format(video_snapshot_at, 'HH:mm:ss')       AS video_snapshot_at_t,\n\n    year(video_snapshot_at)                          AS year,\n    quarter(video_snapshot_at)                       AS quarter,\n    month(video_snapshot_at)                         AS month,\n    day(video_snapshot_at)                           AS day,\n    hour(video_snapshot_at)                          AS hour,\n    minute(video_snapshot_at)                        AS minute,\n    second(video_snapshot_at)                        AS second,\n\n    dayofweek(video_snapshot_at)                     AS dow,\n    substr(date_format(video_snapshot_at, 'EEE'), 1, 1) AS dow_one_letter,\n    date_format(video_snapshot_at, 'EEE')            AS dow_short,\n    date_format(video_snapshot_at, 'EEEE')           AS dow_full,\n    dayofyear(video_snapshot_at)                     AS doy,\n    weekofyear(video_snapshot_at)                    AS week,\n\n    view_count,\n    like_count,\n    favorite_count,\n    comment_count,\n    view_growth,\n    like_growth,\n    favorite_growth,\n    comment_growth,\n\n    title,\n    duration,\n    channel_title,\n    category_name,\n    language_name,\n    region_name,\n    latitude,\n    longitude\n\nFROM gold.videos_enriched\n\n\nWHERE video_snapshot_at >\n    (SELECT max(video_snapshot_at) FROM gold.videos_enriched_tableau)\n", "relation_name": "gold.videos_enriched_tableau", "batch_results": null}], "elapsed_time": 22.053093433380127, "args": {"source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "which": "run", "indirect_selection": "eager", "print": true, "strict_mode": false, "exclude": [], "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": true, "select": ["tag:spark"], "skip_nodes_if_on_run_start_fails": false, "version_check": true, "static_parser": true, "cache_selected_only": false, "macro_debugging": false, "quiet": false, "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "project_dir": "/workspace", "profiles_dir": "/workspace", "require_resource_names_without_spaces": false, "use_colors": true, "use_colors_file": true, "require_batched_execution_for_custom_microbatch_strategy": false, "show_resource_report": false, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "log_level": "info", "favor_state": false, "target": "spark", "empty": false, "partial_parse": true, "introspect": true, "log_path": "/workspace/logs", "log_format": "default", "invocation_command": "dbt run --project-dir /workspace --target spark --select tag:spark", "vars": {}, "defer": false, "write_json": true}}